---
import { Icon } from "astro-icon";
import { Picture } from "@astrojs/image/components";
import RolPill from "./RolPill.astro";
import projectTypes from "../../db/projectTypes.json";
import BorderedAnchor from "./BorderedAnchor.astro";

interface Props {
  id: number;
  name: string;
  fileName: string;
  alt: string;
  description: string;
  projectType: string;
  technologies: string[];
  isEven: boolean;
  loading?: "eager" | "lazy";
}

const {
  id,
  name,
  fileName,
  technologies,
  alt,
  description,
  projectType,
  isEven,
  loading,
} = Astro.props;
const imageURL = `/assets/projects/${fileName}`;
const firstThreeTechs = technologies.slice(0, 3);

const container = isEven ? "" : "flex-row-reverse";
const dataContainer = isEven ? " items-end  right-0" : " items-start left-0";

const shortDescription = description.split(" ").slice(0, 20).join(" ");
---

<div class={`flex flex-1 relative ${container}`}>
  <div class="w-3/5 rounded-md">
    <Picture
      src={imageURL}
      widths={[1200]}
      aspectRatio="16:9"
      sizes="1200px"
      alt={alt}
      loading={loading || "eager"}
    />
  </div>
  <div
    class={`flex flex-col justify-center lg:gap-y-4 xl:gap-y-8 px-5 absolute h-full w-2/5 w- ${dataContainer}`}
  >
    <RolPill bgColor={projectTypes[projectType.toLowerCase()].color}>
      <Icon name={projectTypes[projectType.toLowerCase()].icon} class="w-5" />
      {projectType}
    </RolPill>
    <h4 class="text-2xl font-semibold">{name}</h4>
    <p
      class="bg-customGray-100 lg:p-4 xl:p-6 rounded-md lg:w-[140%] xl:w-[130%] 2xl:w-[120%]"
    >
      {
        "Lorem ipsum dolor sit amet, consectetur adipisicing elit. Corporis, nulla!Ipsam placeat, consectetur atque sed ad dolores tenetur assumenda sapiente consequatur quasi, facilis exercitationem saepe dignissimos eligendi asperiores nulla nostrum."
          .split(" ")
          .slice(0, 20)
          .join(" ")
      }<span class="text-primaryLight">...</span>
    </p>
    <div class="flex justify-center gap-1">
      {
        firstThreeTechs.map((x) => (
          <div class=" bg-customGray-100 whitespace-nowrap px-3 py-1 rounded-sm text-xs">
            {x}
          </div>
        ))
      }
      {
        technologies.length > 3 && (
          <div class=" bg-customGray-100 whitespace-nowrap px-3 py-1 rounded-sm text-xs text-primaryLight">
            ...
          </div>
        )
      }
    </div>
    <BorderedAnchor href={`/projects/${id}`}>Learn More</BorderedAnchor>
  </div>
</div>
